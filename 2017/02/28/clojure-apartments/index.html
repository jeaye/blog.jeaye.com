<!DOCTYPE html><html><head><meta charset="utf-8"/><link rel="icon" type="image/png" href="https://blog.jeaye.com//assets/favicon-c551898801df70b89095c40cbb11f01ff876ecf59bfa153122137abe9459c576.png"><title>Finding an apartment with Clojure</title><meta name="author" content="jeaye"/><meta name="keywords" content="jeaye,jesse,wilkerson,c++,modern,engineering,manager,software,functional,clojure,programming,clojure, apartment, irc, bot, sf, padwatch, apartment-finder"/><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="I'm a leader, a problem solver, and a hacker with a passion for privacy and security."><style>.icon{background-image:url("/assets/sprite-sheet-f829f47fe9f6353c7c632fee71002c94a29b8341725e19843f2c1b263869e4f2.png") !important}</style><style rel="stylesheet" type="text/css" integrity="sha256-FAEL2/AHw4sy6PSxUkN0Zt4TaPhbApIPciXM8UG6d7c=" crossorigin="anonymous">*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}body{display:flex;flex-flow:column nowrap;margin:0;font-family:sans-serif}a{text-decoration:none}.theme-old a{color:#3d92c9}.theme-red a{color:#c93d7a}.theme-teal a{color:#c2363c}.theme-green a{color:#3dc945}.theme-penny a{color:#ec331a}a:hover,a:focus{text-decoration:underline}.theme-old .gentle-body-color{color:#222}.theme-red .gentle-body-color{color:#222}.theme-teal .gentle-body-color{color:#222}.theme-green .gentle-body-color{color:#222}.theme-penny .gentle-body-color{color:#222}.header{display:flex;flex-flow:column wrap;align-items:center;margin:0;padding:2em 40px 2em 40px;text-align:center}.theme-old .header{background:#3d4f5d;color:#999}.theme-red .header{background:#5d3d4a;color:#999}.theme-teal .header{background:#3d5d5d;color:#999}.theme-green .header{background:#3d5d40;color:#999}.theme-penny .header{background:#812d39;color:#999}.header-inner{display:flex;flex-flow:row wrap}.header-description{flex:2;text-align:left;max-width:700px}.header-icon{display:flex;flex:1;justify-content:flex-end}.header-title,.header-short-pitch{margin:0}.header-short-pitch{font-weight:300}.theme-old .header-short-pitch{color:#b0cadb}.theme-red .header-short-pitch{color:#dbb0c3}.theme-teal .header-short-pitch{color:#b0dbd9}.theme-green .header-short-pitch{color:#b0dbb3}.theme-penny .header-short-pitch{color:#ffbbcb}.header-name{font-size:2.5em}.theme-old .header-name{color:#222}.theme-red .header-name{color:#222}.theme-teal .header-name{color:#222}.theme-green .header-name{color:#222}.theme-penny .header-name{color:#222}.nav{display:flex;flex-flow:row wrap;gap:0.5em;padding-top:0.5em}.nav-item{display:flex;flex:1;white-space:nowrap}.nav-item a{background:transparent;margin-top:1em;padding:6px 14px;letter-spacing:0.05em;font-size:85%}.theme-old .nav-item a{color:#fff;border:2px solid #b0cadb}.theme-red .nav-item a{color:#fff;border:2px solid #dbb0c3}.theme-teal .nav-item a{color:#fff;border:2px solid #b0dbd9}.theme-green .nav-item a{color:#fff;border:2px solid #b0dbb3}.theme-penny .nav-item a{color:#fff;border:2px solid #ffbbcb}.nav-item a:hover,.nav-item a:focus{text-decoration:none}.theme-old .nav-item a:hover,.theme-old .nav-item a:focus{border:2px solid #3d92c9}.theme-red .nav-item a:hover,.theme-red .nav-item a:focus{border:2px solid #c93d7a}.theme-teal .nav-item a:hover,.theme-teal .nav-item a:focus{border:2px solid #3dc9c3}.theme-green .nav-item a:hover,.theme-green .nav-item a:focus{border:2px solid #3dc945}.theme-penny .nav-item a:hover,.theme-penny .nav-item a:focus{border:2px solid #ff1345}.theme-old .special-nav-item a{border:2px solid #c2a086}.theme-red .special-nav-item a{border:2px solid #86c2aa}.theme-teal .special-nav-item a{border:2px solid #c28686}.theme-green .special-nav-item a{border:2px solid #c286bc}.theme-penny .special-nav-item a{border:2px solid #87e200}.theme-old .special-nav-item a:hover,.theme-old .special-nav-item a:focus{border:2px solid #c26d36}.theme-red .special-nav-item a:hover,.theme-red .special-nav-item a:focus{border:2px solid #36c285}.theme-teal .special-nav-item a:hover,.theme-teal .special-nav-item a:focus{border:2px solid #c2363c}.theme-green .special-nav-item a:hover,.theme-green .special-nav-item a:focus{border:2px solid #c236ba}.theme-penny .special-nav-item a:hover,.theme-penny .special-nav-item a:focus{border:2px solid #78af26}.panel-h-box{display:flex;flex:1;flex-flow:row wrap;gap:10em;justify-content:center;margin:0 3em 0 3em}.panel-v-box{display:flex;flex-flow:column wrap}.panel-gap{min-width:10em}.panel-subhead{text-transform:uppercase;padding:0;font-size:80%;font-weight:500;letter-spacing:0.1em}.theme-old .panel-subhead{color:#999}.theme-red .panel-subhead{color:#999}.theme-teal .panel-subhead{color:#999}.theme-green .panel-subhead{color:#999}.theme-penny .panel-subhead{color:#999}.main-panel,.toolbox-panel,.pgp-panel,.what-i-do-panel,.main-blog-panel{margin-top:2em}.main-panel{display:flex;flex:2;max-width:1280px;min-width:400px}.toolbox-panel{display:flex;flex:1;flex-flow:column nowrap;max-width:450px;min-width:200px}.what-i-do-panel{display:flex;flex:2;flex-flow:column nowrap;min-width:400px;max-width:900px}.what-i-do-h-box{display:flex;flex-flow:row nowrap;gap:4em;margin-top:1em}.what-i-do-thing{flex:1}.what-i-do-thing-title{font-size:1.0em;line-height:0.5em}.what-i-do-title{font-size:1.0em;line-height:0.5em;text-transform:uppercase;margin-bottom:2em}.theme-old .what-i-do-title{color:#443843}.theme-red .what-i-do-title{color:#443843}.theme-teal .what-i-do-title{color:#443843}.theme-green .what-i-do-title{color:#443843}.theme-penny .what-i-do-title{color:#443843}.what-i-do-big{font-size:2.5em;line-height:1em;font-weight:bold}.theme-old .what-i-do-big{color:#222}.theme-red .what-i-do-big{color:#222}.theme-teal .what-i-do-big{color:#222}.theme-green .what-i-do-big{color:#222}.theme-penny .what-i-do-big{color:#222}.job-title{font-size:2em;margin-bottom:0.2em}.theme-old .job-title{color:#222}.theme-red .job-title{color:#222}.theme-teal .job-title{color:#222}.theme-green .job-title{color:#222}.theme-penny .job-title{color:#222}.job-at{font-size:80%;font-weight:500}.theme-old .job-at{color:#999}.theme-red .job-at{color:#999}.theme-teal .job-at{color:#999}.theme-green .job-at{color:#999}.theme-penny .job-at{color:#999}.job-company{font-size:90%}.theme-old .job-company{color:#3d92c9}.theme-red .job-company{color:#c93d7a}.theme-teal .job-company{color:#c2363c}.theme-green .job-company{color:#3dc945}.theme-penny .job-company{color:#ec331a}.posts{display:flex;justify-content:center;flex-flow:column nowrap;max-width:1280px}.post{padding-bottom:2em}.post-header{display:flex;justify-content:space-between;align-items:center}.post-title{font-size:2em;margin-bottom:0.2em}.theme-old .post-title{color:#222}.theme-red .post-title{color:#222}.theme-teal .post-title{color:#222}.theme-green .post-title{color:#222}.theme-penny .post-title{color:#222}.theme-old .post-title a{color:#222;text-decoration-color:#222}.theme-red .post-title a{color:#222;text-decoration-color:#222}.theme-teal .post-title a{color:#222;text-decoration-color:#222}.theme-green .post-title a{color:#222;text-decoration-color:#222}.theme-penny .post-title a{color:#222;text-decoration-color:#222}.post-description{font-family:Georgia, "Cambria", serif;line-height:1.8em}.theme-old .post-description{color:#222}.theme-red .post-description{color:#222}.theme-teal .post-description{color:#222}.theme-green .post-description{color:#222}.theme-penny .post-description{color:#222}.post-meta{font-size:90%;margin:0}.theme-old .post-meta{color:#222}.theme-red .post-meta{color:#222}.theme-teal .post-meta{color:#222}.theme-green .post-meta{color:#222}.theme-penny .post-meta{color:#222}.post-date{text-align:right;white-space:nowrap}.theme-old .post-date{color:#222}.theme-red .post-date{color:#222}.theme-teal .post-date{color:#222}.theme-green .post-date{color:#222}.theme-penny .post-date{color:#222}.post-updated-date{font-size:90%;font-style:italic}.theme-old .post-updated-date{color:#5aba59}.theme-red .post-updated-date{color:#5aba59}.theme-teal .post-updated-date{color:#5aba59}.theme-green .post-updated-date{color:#5aba59}.theme-penny .post-updated-date{color:#5aba59}.post-category{margin:0 0.1em;padding:0.3em 1em;font-size:80%}.theme-old .post-category{color:#fff;background:#999}.theme-red .post-category{color:#fff;background:#999}.theme-teal .post-category{color:#fff;background:#999}.theme-green .post-category{color:#fff;background:#999}.theme-penny .post-category{color:#fff;background:#999}.theme-old .post-category-review{background:#61b360}.theme-red .post-category-review{background:#61b360}.theme-teal .post-category-review{background:#61b360}.theme-green .post-category-review{background:#61b360}.theme-penny .post-category-review{background:#61b360}.theme-old .post-category-privacy,.theme-old .post-category-security{background:#4d85d1}.theme-red .post-category-privacy,.theme-red .post-category-security{background:#4d85d1}.theme-teal .post-category-privacy,.theme-teal .post-category-security{background:#4d85d1}.theme-green .post-category-privacy,.theme-green .post-category-security{background:#4d85d1}.theme-penny .post-category-privacy,.theme-penny .post-category-security{background:#4d85d1}.theme-old .post-category-rant{background:#8156a7}.theme-red .post-category-rant{background:#8156a7}.theme-teal .post-category-rant{background:#8156a7}.theme-green .post-category-rant{background:#8156a7}.theme-penny .post-category-rant{background:#8156a7}.theme-old .post-category-tutorial{background:#bd4f64}.theme-red .post-category-tutorial{background:#bd4f64}.theme-teal .post-category-tutorial{background:#bd4f64}.theme-green .post-category-tutorial{background:#bd4f64}.theme-penny .post-category-tutorial{background:#bd4f64}.theme-old .post h1,.theme-old h2,.theme-old h3,.theme-old h4{color:#222}.theme-red .post h1,.theme-red h2,.theme-red h3,.theme-red h4{color:#222}.theme-teal .post h1,.theme-teal h2,.theme-teal h3,.theme-teal h4{color:#222}.theme-green .post h1,.theme-green h2,.theme-green h3,.theme-green h4{color:#222}.theme-penny .post h1,.theme-penny h2,.theme-penny h3,.theme-penny h4{color:#222}.post p,.post ol,.post ul{font-family:Georgia, "Cambria", serif}.theme-old .post p,.theme-old .post ol,.theme-old .post ul{color:#222}.theme-red .post p,.theme-red .post ol,.theme-red .post ul{color:#222}.theme-teal .post p,.theme-teal .post ol,.theme-teal .post ul{color:#222}.theme-green .post p,.theme-green .post ol,.theme-green .post ul{color:#222}.theme-penny .post p,.theme-penny .post ol,.theme-penny .post ul{color:#222}.post p a{font-weight:600}.skills{margin:0;padding:0 3em 0 0}.skill{display:flex;gap:1em;padding:1em 0;border-bottom:1px solid #ccc}.skill:last-child{border:none !important}.skill-name{font-size:0.8em;font-weight:bold;align-self:center}.theme-old .skill-name{color:#222}.theme-red .skill-name{color:#222}.theme-teal .skill-name{color:#222}.theme-green .skill-name{color:#222}.theme-penny .skill-name{color:#222}.main-blog-panel{display:flex;justify-content:center;margin-left:10em;margin-right:10em}.blog-header{display:flex;flex-flow:row nowrap;justify-content:space-between}.border-bottom{border-bottom:1px solid #eee}.related-list{list-style-type:none}.related-list li{padding-bottom:0.5em;border-bottom:1px solid #ccc}.related-list li:last-child{border:none}.related-post-title{font-size:1em;margin-bottom:0.2em}.theme-old .related-post-title{color:#222}.theme-red .related-post-title{color:#222}.theme-teal .related-post-title{color:#222}.theme-green .related-post-title{color:#222}.theme-penny .related-post-title{color:#222}.theme-old .related-post-title a{color:#222;text-decoration-color:#222}.theme-red .related-post-title a{color:#222;text-decoration-color:#222}.theme-teal .related-post-title a{color:#222;text-decoration-color:#222}.theme-green .related-post-title a{color:#222;text-decoration-color:#222}.theme-penny .related-post-title a{color:#222;text-decoration-color:#222}figure{text-align:center;margin:0 auto}figure img{border:1px solid rgba(50,50,50,0.5);border-radius:2px;padding:5px;background:#fff}.figure-2-3{width:66%}figcaption{padding:1em 1em 2em 1em;word-wrap:normal;text-align:center;display:inline-block !important;width:66%}code{overflow:auto}.icon-feed{background-position:0px 0px;width:24px;height:30px}.icon-j{background-position:-24px 0px;width:158px;height:155px}code:not([id='typeans']){padding-left:5px;padding-right:5px;border:1px solid;border-color:lightgrey;border-radius:5px}pre code{padding:5px}.highlight .lineno{color:#ccc;display:inline-block;padding:0 5px;border-right:1px solid #ccc}.highlight pre code{display:block;white-space:pre-wrap;overflow-x:auto;word-wrap:normal}.highlight .hll{background-color:#49483e}.highlight{background:#272822;color:#f8f8f2;border-radius:5px}.highlight .c{color:#75715e}.highlight .err{color:#960050;background-color:#1e0010}.highlight .k{color:#66d9ef}.highlight .l{color:#ae81ff}.highlight .n{color:#f8f8f2}.highlight .o{color:#f92672}.highlight .p{color:#f8f8f2}.highlight .ch{color:#75715e}.highlight .cm{color:#75715e}.highlight .cp{color:#75715e}.highlight .cpf{color:#75715e}.highlight .c1{color:#75715e}.highlight .cs{color:#75715e}.highlight .gd{color:#f92672}.highlight .ge{font-style:italic}.highlight .gi{color:#a6e22e}.highlight .gs{font-weight:bold}.highlight .gu{color:#75715e}.highlight .kc{color:#66d9ef}.highlight .kd{color:#66d9ef}.highlight .kn{color:#f92672}.highlight .kp{color:#66d9ef}.highlight .kr{color:#66d9ef}.highlight .kt{color:#66d9ef}.highlight .ld{color:#e6db74}.highlight .m{color:#ae81ff}.highlight .s{color:#e6db74}.highlight .na{color:#a6e22e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#a6e22e}.highlight .no{color:#66d9ef}.highlight .nd{color:#a6e22e}.highlight .ni{color:#f8f8f2}.highlight .ne{color:#a6e22e}.highlight .nf{color:#a6e22e}.highlight .nl{color:#f8f8f2}.highlight .nn{color:#f8f8f2}.highlight .nx{color:#a6e22e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f92672}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f92672}.highlight .w{color:#f8f8f2}.highlight .mb{color:#ae81ff}.highlight .mf{color:#ae81ff}.highlight .mh{color:#ae81ff}.highlight .mi{color:#ae81ff}.highlight .mo{color:#ae81ff}.highlight .sa{color:#e6db74}.highlight .sb{color:#e6db74}.highlight .sc{color:#e6db74}.highlight .dl{color:#e6db74}.highlight .sd{color:#e6db74}.highlight .s2{color:#e6db74}.highlight .se{color:#ae81ff}.highlight .sh{color:#e6db74}.highlight .si{color:#e6db74}.highlight .sx{color:#e6db74}.highlight .sr{color:#e6db74}.highlight .s1{color:#e6db74}.highlight .ss{color:#e6db74}.highlight .bp{color:#f8f8f2}.highlight .fm{color:#a6e22e}.highlight .vc{color:#f8f8f2}.highlight .vg{color:#f8f8f2}.highlight .vi{color:#f8f8f2}.highlight .vm{color:#f8f8f2}.highlight .il{color:#ae81ff}
</style><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="/feed.xml"/></head><body class="theme-penny"><div class="header"><div class="header-inner"><div class="header-description"><h1 class="header-title">My name is <span class="header-name">Jeaye</span></h1><h2 class="header-short-pitch">I'm a leader, a problem solver, and a hacker with a passion for privacy and security.</h2></div><div class="header-icon"><div class="icon icon-j"></div></div></div><nav class="nav"><div class="nav-item"> <a href="https://jeaye.com/">About</a></div><div class="nav-item"> <a href="https://github.com/jeaye">Github</a></div><div class="nav-item"> <a href="/">Blog</a></div><div class="nav-item"> <a href="https://jeaye.com/contact">Contact</a></div><div class="nav-item special-nav-item"> <a href="https://jeaye.com/contact">Hire Me!</a></div> </nav></div><div class="main-blog-panel"><div class="posts"> <section class="post"> <header class="post-header"><h2 class="post-title"> <a href="/2017/02/28/clojure-apartments/" title="/2017/02/28/clojure-apartments/"> Finding an apartment with Clojure </a></h2><div class="post-date"> February 28, 2017</div> </header><p>Finding a reasonably-priced apartment in the Bay Area can be a stressful job. After factoring in the pressure of an expiring lease, making a poor decision can be even easier. One approach to weeding out the influx of duplicated, spammy, and unwanted postings is to use a bot and a set of filters. Such a bot could crawl various apartment listing sites, match all listings against your filters, and report to you in whichever format you prefer: email, HipChat, IRC, RSS, etc. Such a bot may look something like this.</p><h3 id="existing-bots">Existing bots</h3><p>Arguably the most well-known apartment finding bot was created and documented by Vik Paruchuri <a href="https://www.dataquest.io/blog/apartment-finding-slackbot/">here</a>. It takes a very similar approach to what I’ve done, but uses imperative Python and Slack. For those interested in researching such a bot in Python, that’d be a great resource. For my research, a bot in Clojure would prove to be more fun to write.</p><h3 id="padwatch">Padwatch</h3><p><a href="https://github.com/jeaye/padwatch">Padwatch</a> is an apartment finding bot written in Clojure, which is designed to work with <a href="https://craigslist.org/">Craigslist</a> and <a href="https://www.zillow.com/">Zillow</a>. Both sources provide HTML content which follows specific patterns and is “scrapable” in an automated fashion. The key behind the logic for doing web scraping in Clojure is <a href="https://github.com/cgrand/enlive">Enlive</a>; it’s superb for performing queries on HTML data.</p><h4 id="example-usage-of-enlive">Example usage of Enlive</h4><p>Let’s say the goal is to pull out some Craigslist apartment information. It would be possible to use the following to download and parse the HTML into a Clojure data structure:</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">html-data</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="s">"https://stockton.craigslist.org/search/apa?max_price=3000"</span><span class="w">
                   </span><span class="n">java.net.URL.</span><span class="w">
                   </span><span class="n">enlive/html-resource</span><span class="p">))</span><span class="w">
</span></code></pre></div></div><p>From there, it’s possible to make queries on that data. By inspecting the HTML in a browser, it’s clear that each apartment listing is in a <code class="highlighter-rouge">&lt;p&gt;</code> tag and has a class of <code class="highlighter-rouge">result-info</code>. It’s possible then, with Enlive, to pull out all entities which match that pattern:</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">; Pull out just the rows of results from all of the HTML</span><span class="w">
</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">select-rows</span><span class="w"> </span><span class="p">[</span><span class="n">html-data</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="nf">enlive/select</span><span class="w"> </span><span class="n">html-data</span><span class="w"> </span><span class="p">[</span><span class="no">:p.result-info</span><span class="p">]))</span><span class="w">

</span><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="p">(</span><span class="nf">select-rows</span><span class="w"> </span><span class="n">html-data</span><span class="p">))</span><span class="w">
</span></code></pre></div></div><p>After that selection, <code class="highlighter-rouge">rows</code> is just a Clojure <a href="https://clojure.org/reference/data_structures#Vectors">vector</a>, where each element represents the contents of the matched <code class="highlighter-rouge">&lt;p&gt;</code> entity. Now, the HTML of a given row contains something like this:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Note, here's the :p.result-info referenced from above. --&gt;</span>
<span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"result-info"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"icon icon-star"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">title=</span><span class="s">"save this post in your favorites list"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"screen-reader-text"</span><span class="nt">&gt;</span>favorite this post<span class="nt">&lt;/span&gt;</span>
  <span class="nt">&lt;/span&gt;</span>

  <span class="c">&lt;!-- There's information here about the post date. --&gt;</span>
  <span class="nt">&lt;time</span> <span class="na">class=</span><span class="s">"result-date"</span> <span class="na">datetime=</span><span class="s">"2016-03-18 12:26"</span> <span class="na">title=</span><span class="s">"Mon 07 Mar 12:22:08 PM"</span><span class="nt">&gt;</span>Mar 07<span class="nt">&lt;/time&gt;</span>

  <span class="c">&lt;!-- This is a link to the page specifically for this listing, as well as its street address. --&gt;</span>
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/apa/3299094122.html"</span> <span class="na">data-id=</span><span class="s">"3299094122"</span> <span class="na">class=</span><span class="s">"result-title hdrlnk"</span><span class="nt">&gt;</span>1672 Hidden alley place<span class="nt">&lt;/a&gt;</span>

  <span class="c">&lt;!-- Herein lies the price, bedroom/bath count, and neighborhood. --&gt;</span>
  <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"result-meta"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"result-price"</span><span class="nt">&gt;</span>$2200<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"housing"</span><span class="nt">&gt;</span> 5br - <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"result-hood"</span><span class="nt">&gt;</span> (sacramento)<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"result-tags"</span><span class="nt">&gt;</span>
      pic
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"maptag"</span> <span class="na">data-pid=</span><span class="s">"3299094122"</span><span class="nt">&gt;</span>map<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"banish icon icon-trash"</span> <span class="na">role=</span><span class="s">"button"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"screen-reader-text"</span><span class="nt">&gt;</span>hide this posting<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"unbanish icon icon-trash red"</span> <span class="na">role=</span><span class="s">"button"</span> <span class="na">aria-hidden=</span><span class="s">"true"</span><span class="nt">&gt;&lt;/span&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">class=</span><span class="s">"restore-link"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"restore-narrow-text"</span><span class="nt">&gt;</span>restore<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"restore-wide-text"</span><span class="nt">&gt;</span>restore this posting<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/p&gt;</span>
</code></pre></div></div><p>To pull out that data into our row data, it’s possible to do the following:</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">; Helper to pull out the first match of an Enlive select</span><span class="w">
</span><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">select-first</span><span class="w"> </span><span class="p">(</span><span class="nb">comp</span><span class="w"> </span><span class="nb">first</span><span class="w"> </span><span class="n">enlive/select</span><span class="p">))</span><span class="w">

</span><span class="c1">; Take in a single row and a map onto which to assoc the extracted date </span><span class="w">
</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">row-post-date</span><span class="w"> </span><span class="p">[</span><span class="n">row-data</span><span class="w"> </span><span class="n">row</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">post-date</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">select-first</span><span class="w"> </span><span class="n">row-data</span><span class="w"> </span><span class="p">[</span><span class="no">:time</span><span class="p">])</span><span class="w"> </span><span class="no">:attrs</span><span class="w"> </span><span class="no">:datetime</span><span class="p">)]</span><span class="w">
    </span><span class="p">(</span><span class="nb">assoc</span><span class="w"> </span><span class="n">row</span><span class="w">
           </span><span class="no">:post-date</span><span class="w"> </span><span class="n">post-date</span><span class="p">)))</span><span class="w">

</span><span class="p">(</span><span class="nf">row-post-date</span><span class="w"> </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="n">rows</span><span class="p">)</span><span class="w"> </span><span class="p">{})</span><span class="w"> </span><span class="c1">; possible output: {:post-date "2016-03-18 12:26"}</span><span class="w">

</span><span class="c1">; Same format as above, but assoc in the row's price, if it's valid</span><span class="w">
</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">row-price</span><span class="w"> </span><span class="p">[</span><span class="n">row-data</span><span class="w"> </span><span class="n">row</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">price-str</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">select-first</span><span class="w"> </span><span class="n">row-data</span><span class="w"> </span><span class="p">[</span><span class="no">:span.result-price</span><span class="p">])</span><span class="w">
                      </span><span class="no">:content</span><span class="w">
                      </span><span class="nb">first</span><span class="p">)</span><span class="w">
        </span><span class="n">valid?</span><span class="w"> </span><span class="p">(</span><span class="nb">re-matches</span><span class="w"> </span><span class="o">#</span><span class="s">"\$\d+"</span><span class="w"> </span><span class="p">(</span><span class="nb">or</span><span class="w"> </span><span class="n">price-str</span><span class="w"> </span><span class="s">""</span><span class="p">))</span><span class="w">
        </span><span class="n">price</span><span class="w"> </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="n">valid?</span><span class="w">
                </span><span class="p">(</span><span class="nf">Integer/parseInt</span><span class="w"> </span><span class="p">(</span><span class="nb">subs</span><span class="w"> </span><span class="n">price-str</span><span class="w"> </span><span class="mi">1</span><span class="p">)))]</span><span class="w">
    </span><span class="p">(</span><span class="nb">assoc</span><span class="w"> </span><span class="n">row</span><span class="w">
           </span><span class="no">:price</span><span class="w"> </span><span class="n">price</span><span class="p">)))</span><span class="w">

</span><span class="p">(</span><span class="nf">row-price</span><span class="w"> </span><span class="p">(</span><span class="nb">first</span><span class="w"> </span><span class="n">rows</span><span class="p">)</span><span class="w"> </span><span class="p">{})</span><span class="w"> </span><span class="c1">; possible output: {:price 2300}</span><span class="w">
</span></code></pre></div></div><p>As is hopefully quite clear, with a number of <a href="https://en.wikipedia.org/wiki/Pure_function">pure</a>, concise functions, it’s possible to extract a great deal of information about a given apartment listing. The benefit of having these functions be individual and pure is that they’re both composable and easy to debug/reason about. That is, a function like <code class="highlighter-rouge">row-post-date</code> has the simple task of selecting some data and transforming some other data before returning it. The reader of the function doesn’t need to worry about global state, which may be mutated, affecting the result of the function. The reader also needn’t worry about thread safety, since these pure functions are using Clojure’s persistent, immutable data structures. This is the benefit of <a href="http://www.braveclojure.com/functional-programming/">functional programming</a> with Clojure.</p><p>By combining those functions together, in a reduction, it’s straightforward to build up a model of a given listing.</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">reduce</span><span class="w"> </span><span class="o">#</span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="n">%1</span><span class="w">
           </span><span class="p">(</span><span class="nf">%2</span><span class="w"> </span><span class="n">rows</span><span class="w"> </span><span class="n">%1</span><span class="p">))</span><span class="w">
        </span><span class="p">{}</span><span class="w"> </span><span class="c1">; Starting with an empty map</span><span class="w">
        </span><span class="p">[</span><span class="n">row-link</span><span class="w"> </span><span class="n">row-post-date</span><span class="w"> </span><span class="n">row-price</span><span class="w"> </span><span class="n">row-where</span><span class="p">])</span><span class="w"> </span><span class="c1">; All of the extractors</span><span class="w">

</span><span class="c1">; Example simulation of data:</span><span class="w">
</span><span class="c1">; 1. Reduce calls the first extractor with the empty map</span><span class="w">
</span><span class="p">(</span><span class="nf">row-link</span><span class="w"> </span><span class="p">{})</span><span class="w">
  </span><span class="n">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="p">}</span><span class="w"> </span><span class="c1">; output</span><span class="w">

</span><span class="c1">; 2. The result of that is then collected and the next extractor is called</span><span class="w">
</span><span class="p">(</span><span class="nf">row-post-date</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="p">})</span><span class="w">
  </span><span class="n">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="w">
      </span><span class="no">:post-date</span><span class="w"> </span><span class="s">"Feb 2 of the 5th ice age"</span><span class="p">}</span><span class="w">

</span><span class="c1">; 3. Rinse and repeat</span><span class="w">
</span><span class="p">(</span><span class="nf">row-price</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="w">
            </span><span class="no">:post-date</span><span class="w"> </span><span class="s">"Feb 2 of the 5th ice age"</span><span class="p">})</span><span class="w">
  </span><span class="n">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="w">
      </span><span class="no">:post-date</span><span class="w"> </span><span class="s">"Feb 2 of the 5th ice age"</span><span class="w">
      </span><span class="no">:price</span><span class="w"> </span><span class="mi">2300</span><span class="p">}</span><span class="w">

</span><span class="p">(</span><span class="nf">row-where</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="w">
            </span><span class="no">:post-date</span><span class="w"> </span><span class="s">"Feb 2 of the 5th ice age"</span><span class="w">
            </span><span class="no">:price</span><span class="w"> </span><span class="mi">2300</span><span class="p">})</span><span class="w">
  </span><span class="n">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="no">:link</span><span class="w"> </span><span class="s">"http://craigslist.com/foo/blah"</span><span class="w">
      </span><span class="no">:post-date</span><span class="w"> </span><span class="s">"Feb 2 of the 5th ice age"</span><span class="w">
      </span><span class="no">:price</span><span class="w"> </span><span class="mi">2300</span><span class="w">
      </span><span class="no">:where</span><span class="w"> </span><span class="s">"sacramento"</span><span class="p">}</span><span class="w">

</span><span class="c1">; The last result is the return value of the reduction. It's the map which</span><span class="w">
</span><span class="c1">; describes the whole row, based on the extractors. It's the apartment data!</span><span class="w">
</span></code></pre></div></div><h4 id="reporting-the-data">Reporting the data</h4><p>For easy IRC access in Clojure, it’s likely you’ll turn to the late Raynes’ <a href="https://github.com/Raynes/irclj">irclj</a>. The API is minimal and can be wrapped with just a few lines.</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">nick</span><span class="w"> </span><span class="s">"padwatch"</span><span class="p">)</span><span class="w">
</span><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="s">"#padwatch"</span><span class="p">)</span><span class="w">

</span><span class="p">(</span><span class="k">def</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="p">(</span><span class="nf">atom</span><span class="w"> </span><span class="n">nil</span><span class="p">))</span><span class="w">

</span><span class="c1">; By default, logs go to stdout; use this to quiet them</span><span class="w">
</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">eat-log</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="w"> </span><span class="n">args</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="nb">comment</span><span class="w"> </span><span class="n">pprint</span><span class="w"> </span><span class="n">args</span><span class="p">))</span><span class="w">

</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">disconnect!</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="o">@</span><span class="n">connection</span><span class="w">
    </span><span class="p">(</span><span class="nf">swap!</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">irc/kill</span><span class="p">)))</span><span class="w">

</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">connect!</span><span class="w"> </span><span class="p">[]</span><span class="w">
  </span><span class="p">(</span><span class="nf">disconnect!</span><span class="p">)</span><span class="w">
  </span><span class="p">(</span><span class="nf">reset!</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="p">(</span><span class="nf">irc/connect</span><span class="w"> </span><span class="s">"irc.freenode.net"</span><span class="w">
                                  </span><span class="mi">6667</span><span class="w"> </span><span class="n">nick</span><span class="w">
                                  </span><span class="no">:callbacks</span><span class="w"> </span><span class="p">{</span><span class="no">:raw-log</span><span class="w"> </span><span class="n">eat-log</span><span class="p">}))</span><span class="w">
  </span><span class="p">(</span><span class="nf">irc/join</span><span class="w"> </span><span class="o">@</span><span class="n">connection</span><span class="w"> </span><span class="n">channel</span><span class="p">))</span><span class="w">

</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">message!</span><span class="w"> </span><span class="p">[</span><span class="n">msg</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="nf">irc/message</span><span class="w"> </span><span class="o">@</span><span class="n">connection</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="n">msg</span><span class="p">))</span><span class="w">
</span></code></pre></div></div><p>From there, reporting listings as they come in should be no problem. To make the output more terse, some URL shortening can specific formatting could be applied.</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">; Take a url and return the shortened one, if possible</span><span class="w">
</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">shorten-url</span><span class="w"> </span><span class="p">[</span><span class="n">url</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="nb">when</span><span class="w"> </span><span class="n">url</span><span class="w">
    </span><span class="p">(</span><span class="nf">try</span><span class="w">
      </span><span class="p">(</span><span class="nb">slurp</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="s">"http://tinyurl.com/api-create.php?url="</span><span class="w"> </span><span class="n">url</span><span class="p">))</span><span class="w">
      </span><span class="p">(</span><span class="nf">catch</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="c1">; tinyurl can time out; just skip the shortening</span><span class="w">
        </span><span class="n">url</span><span class="p">))))</span><span class="w">

</span><span class="p">(</span><span class="k">defn</span><span class="w"> </span><span class="n">message-row!</span><span class="w"> </span><span class="p">[</span><span class="n">row-info</span><span class="p">]</span><span class="w">
  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">useful</span><span class="w"> </span><span class="p">(</span><span class="nb">merge</span><span class="w"> </span><span class="p">(</span><span class="nb">select-keys</span><span class="w"> </span><span class="n">row-info</span><span class="w"> </span><span class="p">[</span><span class="no">:where</span><span class="w"> </span><span class="no">:style</span><span class="w"> </span><span class="no">:price</span><span class="w"> </span><span class="no">:sqft</span><span class="p">])</span><span class="w">
                      </span><span class="p">{</span><span class="no">:url</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="n">row-info</span><span class="w"> </span><span class="no">:url</span><span class="w"> </span><span class="n">shorten-url</span><span class="p">)</span><span class="w">
                       </span><span class="no">:walkscore</span><span class="w"> </span><span class="p">(</span><span class="nb">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="no">:walkscore</span><span class="w"> </span><span class="n">row-info</span><span class="p">)</span><span class="w">
                                      </span><span class="p">(</span><span class="nf">update</span><span class="w"> </span><span class="no">:url</span><span class="w"> </span><span class="n">shorten-url</span><span class="p">)</span><span class="w">
                                      </span><span class="p">(</span><span class="nb">dissoc</span><span class="w"> </span><span class="no">:description</span><span class="p">))})]</span><span class="w">
    </span><span class="p">(</span><span class="nf">irc/message</span><span class="w"> </span><span class="o">@</span><span class="n">connection</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="p">(</span><span class="nb">pr-str</span><span class="w"> </span><span class="n">useful</span><span class="p">))))</span><span class="w">
</span></code></pre></div></div><h3 id="accessing-other-services-for-more-detailed-information">Accessing other services for more detailed information</h3><p>Padwatch also takes advantage of a few other free services, to improve the reported data. Among them, <a href="https://www.walkscore.com/">WalkScore</a> is notable for having a simple API. After signing up and getting a free API key, one can make a limited number of requests per day. Since most Craigslist apartment listings contain the <a href="https://en.wikipedia.org/wiki/Geotagging">geo tag</a> of the apartment, that information can be sent to Walkscore in order to get accurate information regarding the proximity of shops, transit, and landmarks.</p><p>Some listings, however, don’t contain any sort of positional information, aside from the street address. To work around that, Padwatch uses the free <a href="https://geocoding.geo.census.gov/geocoder/geographies/onelineaddress?address=9366+Perry+St+Westminster+CO&amp;benchmark=4&amp;vintage=4">Census Geocoding</a> service in order to turn street addresses into latitude &amp; longitude pairs. That information can then be sent into WalkScore to get accurate results.</p><h3 id="configuration">Configuration</h3><p>Since Padwatch is written in Clojure, using its idioms, configuration is done in a declarative <a href="https://github.com/edn-format/edn">EDN</a> file. Fortunately, EDN’s format is just Clojure data, so, since Clojure is <a href="https://en.wikipedia.org/wiki/Homoiconicity">homoiconic</a>, it reads just like Clojure code.</p><p>The structure of the config map sets up some ranges and limits for prices, walkscores, bed/bathrooms, etc. There’s also a map of sources, to provide source-specific configuration. Sources include Craigslist, Zillow, Walkscore, and Census Geocoding. Here’s an example <code class="highlighter-rouge">config.edn</code>:</p><div class="language-clojure highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">min-price</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="n">max-price</span><span class="w"> </span><span class="mi">3000</span><span class="w">
      </span><span class="n">min-sqft</span><span class="w"> </span><span class="mi">600</span><span class="w"> </span><span class="n">max-sqft</span><span class="w"> </span><span class="mi">1000</span><span class="w">
      </span><span class="n">bedrooms</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">bathrooms</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="n">min-walkscore</span><span class="w"> </span><span class="mi">60</span><span class="p">]</span><span class="w">
  </span><span class="p">{</span><span class="no">:min-price</span><span class="w"> </span><span class="n">min-price</span><span class="w"> </span><span class="no">:max-price</span><span class="w"> </span><span class="n">max-price</span><span class="w">
   </span><span class="no">:min-sqft</span><span class="w"> </span><span class="n">min-sqft</span><span class="w"> </span><span class="no">:max-sqft</span><span class="w"> </span><span class="n">max-sqft</span><span class="w">
   </span><span class="no">:bedrooms</span><span class="w"> </span><span class="n">bedrooms</span><span class="w"> </span><span class="no">:bathrooms</span><span class="w"> </span><span class="n">bathrooms</span><span class="w">
   </span><span class="no">:min-walkscore</span><span class="w"> </span><span class="n">min-walkscore</span><span class="w">
   </span><span class="no">:source</span><span class="w"> </span><span class="p">{</span><span class="no">:craigslist</span><span class="w"> </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">base-url</span><span class="w"> </span><span class="s">"https://sfbay.craigslist.org"</span><span class="w">
                              </span><span class="n">max-rows</span><span class="w"> </span><span class="mi">20</span><span class="p">]</span><span class="w">
                          </span><span class="p">{</span><span class="no">:source</span><span class="w"> </span><span class="s">"craigslist"</span><span class="w">
                           </span><span class="no">:enabled?</span><span class="w"> </span><span class="n">true</span><span class="w">
                           </span><span class="no">:base-url</span><span class="w"> </span><span class="n">base-url</span><span class="w">
                           </span><span class="no">:search-url</span><span class="w"> </span><span class="p">(</span><span class="nb">str</span><span class="w"> </span><span class="n">base-url</span><span class="w"> </span><span class="s">"/search/apa"</span><span class="p">)</span><span class="w">
                           </span><span class="no">:max-rows</span><span class="w"> </span><span class="n">max-rows</span><span class="w">
                           </span><span class="no">:cycle-length-ms</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="n">max-rows</span><span class="p">)</span><span class="w"> </span><span class="c1">; Amortize minutes per row</span><span class="w">
                           </span><span class="no">:params</span><span class="w"> </span><span class="p">{</span><span class="no">:min_price</span><span class="w"> </span><span class="n">min-price</span><span class="w"> </span><span class="no">:max_price</span><span class="w"> </span><span class="n">max-price</span><span class="w">
                                    </span><span class="no">:minSqft</span><span class="w"> </span><span class="n">min-sqft</span><span class="w"> </span><span class="no">:maxSqft</span><span class="w"> </span><span class="n">max-sqft</span><span class="w">
                                    </span><span class="no">:bedrooms</span><span class="w"> </span><span class="n">bedrooms</span><span class="w"> </span><span class="no">:bathrooms</span><span class="w"> </span><span class="n">bathrooms</span><span class="w">
                                    </span><span class="no">:no_smoking</span><span class="w"> </span><span class="mi">1</span><span class="w">
                                    </span><span class="no">:availabilityMode</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c1">; All dates</span><span class="w">
                                    </span><span class="no">:hasPic</span><span class="w"> </span><span class="mi">1</span><span class="w">
                                    </span><span class="no">:sort</span><span class="w"> </span><span class="s">"date"</span><span class="w">
                                    </span><span class="no">:search_distance</span><span class="w"> </span><span class="mi">3</span><span class="w">
                                    </span><span class="no">:postal</span><span class="w"> </span><span class="mi">94010</span><span class="w">
                                    </span><span class="no">:bundleDuplicates</span><span class="w"> </span><span class="mi">0</span><span class="p">}})</span><span class="w">
            </span><span class="no">:zillow</span><span class="w"> </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">[</span><span class="n">zones</span><span class="w"> </span><span class="p">[</span><span class="s">"belmont-ca"</span><span class="w"> </span><span class="s">"half-moon-bay-ca"</span><span class="w">
                                 </span><span class="s">"highlands-baywood-park-ca"</span><span class="w"> </span><span class="s">"hillsborough-ca"</span><span class="w">
                                 </span><span class="s">"pacifica-ca"</span><span class="w"> </span><span class="s">"san-bruno-ca"</span><span class="w">
                                 </span><span class="s">"south-san-francisco-ca"</span><span class="w"> </span><span class="s">"brisbane-ca"</span><span class="w">
                                 </span><span class="s">"daly-city-ca"</span><span class="w"> </span><span class="s">"colma-ca"</span><span class="w"> </span><span class="s">"millbrae-ca"</span><span class="w">
                                 </span><span class="s">"oakland-ca"</span><span class="w"> </span><span class="s">"san-francisco-ca"</span><span class="w"> </span><span class="s">"piedmont-ca"</span><span class="w">
                                 </span><span class="s">"berkeley-ca"</span><span class="w"> </span><span class="s">"albany-ca"</span><span class="w"> </span><span class="s">"richmond-ca"</span><span class="w">
                                 </span><span class="s">"emeryville-ca"</span><span class="w">
                                 </span><span class="s">"burlingame-ca"</span><span class="w"> </span><span class="s">"san-mateo-ca"</span><span class="p">]]</span><span class="w">
                      </span><span class="p">{</span><span class="no">:source</span><span class="w"> </span><span class="s">"zillow"</span><span class="w">
                       </span><span class="no">:enabled?</span><span class="w"> </span><span class="n">false</span><span class="w">
                       </span><span class="no">:base-url</span><span class="w"> </span><span class="s">"http://www.zillow.com"</span><span class="w">
                       </span><span class="no">:cycle-length-ms</span><span class="w"> </span><span class="p">(</span><span class="nb">*</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="nb">count</span><span class="w"> </span><span class="n">zones</span><span class="p">))</span><span class="w"> </span><span class="c1">; Amortize minutes per zone</span><span class="w">
                       </span><span class="no">:zones</span><span class="w"> </span><span class="n">zones</span><span class="p">})</span><span class="w">
            </span><span class="no">:walkscore</span><span class="w"> </span><span class="p">{</span><span class="no">:key</span><span class="w"> </span><span class="s">"XXX-FILL-THIS-IN-XXX"</span><span class="w">
                        </span><span class="no">:format-url</span><span class="w"> </span><span class="s">"http://api.walkscore.com/score?format=json&amp;lat=%s&amp;lon=%s&amp;wsapikey=%s"</span><span class="p">}</span><span class="w">
            </span><span class="no">:census-geo</span><span class="w"> </span><span class="p">{</span><span class="no">:format-url</span><span class="w"> </span><span class="s">"https://geocoding.geo.census.gov/geocoder/geographies/onelineaddress?address=%s&amp;benchmark=4&amp;vintage=4"</span><span class="p">}}})</span><span class="w">
</span></code></pre></div></div><h3 id="a-note-on-terms-of-service">A note on terms of service</h3><p>Craigslist, Zillow, and likely most other apartment listing websites have listed, in their terms of service (to which you agree by using their service), that scraping their data with bots is not permitted. You need to know this.</p><h3 id="summary">Summary</h3><p>To me, this was a perfect use case for Clojure: data in, data out. Lots of pure transformations, querying of deep data structures, and the occasional side effect (writing to the db to minimize duplicates, reporting listings to IRC). If you’re interested in learning more about Clojure, I recommend, first and foremost, you read through <a href="http://www.braveclojure.com/">Brave Clojure</a>.</p></section><hr/><div><div class="border-bottom"><h1 class="panel-subhead">Related posts</h1><ul class="related-list"><li><h2 class="related-post-title"> <a href="/2017/10/31/clojure-keywords/">The five common forms of Clojure keywords</a> <span class="post-category post-category-clojure">clojure</span></h2></li><li><h2 class="related-post-title"> <a href="/2017/09/30/clojurescript-promesa/">Async/await in ClojureScript with Promesa</a> <span class="post-category post-category-clojure">clojure</span></h2></li><li><h2 class="related-post-title"> <a href="/2017/08/31/clojure-code-quality/">The state of code quality tools in Clojure</a> <span class="post-category post-category-clojure">clojure</span></h2></li><li><h2 class="related-post-title"> <a href="/2017/06/30/orchestra-cljs/">Porting Orchestra to ClojureScript</a> <span class="post-category post-category-clojure">clojure</span></h2></li></ul></div></div></div></div></div> <footer> </footer></body></html>